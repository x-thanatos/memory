{"id":"+LyD","dependencies":[{"name":"@babel/runtime-corejs2/helpers/interopRequireDefault","loc":{"line":3,"column":37},"parent":"/Users/thanatos/projects/memory/node_modules/next-server/dist/lib/p-queue.js","resolved":"/Users/thanatos/projects/memory/node_modules/next-server/node_modules/@babel/runtime-corejs2/helpers/interopRequireDefault.js"},{"name":"@babel/runtime-corejs2/core-js/promise","loc":{"line":10,"column":46},"parent":"/Users/thanatos/projects/memory/node_modules/next-server/dist/lib/p-queue.js","resolved":"/Users/thanatos/projects/memory/node_modules/next-server/node_modules/@babel/runtime-corejs2/core-js/promise.js"},{"name":"@babel/runtime-corejs2/core-js/object/assign","loc":{"line":12,"column":45},"parent":"/Users/thanatos/projects/memory/node_modules/next-server/dist/lib/p-queue.js","resolved":"/Users/thanatos/projects/memory/node_modules/next-server/node_modules/@babel/runtime-corejs2/core-js/object/assign.js"},{"name":"@babel/runtime-corejs2/helpers/classCallCheck","loc":{"line":14,"column":54},"parent":"/Users/thanatos/projects/memory/node_modules/next-server/dist/lib/p-queue.js","resolved":"/Users/thanatos/projects/memory/node_modules/next-server/node_modules/@babel/runtime-corejs2/helpers/classCallCheck.js"},{"name":"@babel/runtime-corejs2/helpers/createClass","loc":{"line":16,"column":51},"parent":"/Users/thanatos/projects/memory/node_modules/next-server/dist/lib/p-queue.js","resolved":"/Users/thanatos/projects/memory/node_modules/next-server/node_modules/@babel/runtime-corejs2/helpers/createClass.js"}],"generated":{"js":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime-corejs2/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _promise = _interopRequireDefault(require(\"@babel/runtime-corejs2/core-js/promise\"));\n\nvar _assign = _interopRequireDefault(require(\"@babel/runtime-corejs2/core-js/object/assign\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime-corejs2/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime-corejs2/helpers/createClass\")); // based on https://github.com/sindresorhus/p-queue (MIT)\n// modified for browser support\n\n\nvar Queue =\n/*#__PURE__*/\nfunction () {\n  function Queue() {\n    (0, _classCallCheck2.default)(this, Queue);\n    this._queue = [];\n  }\n\n  (0, _createClass2.default)(Queue, [{\n    key: \"enqueue\",\n    value: function enqueue(run) {\n      this._queue.push(run);\n    }\n  }, {\n    key: \"dequeue\",\n    value: function dequeue() {\n      return this._queue.shift();\n    }\n  }, {\n    key: \"size\",\n    get: function get() {\n      return this._queue.length;\n    }\n  }]);\n  return Queue;\n}();\n\nvar PQueue =\n/*#__PURE__*/\nfunction () {\n  function PQueue(opts) {\n    (0, _classCallCheck2.default)(this, PQueue);\n    opts = (0, _assign.default)({\n      concurrency: Infinity,\n      queueClass: Queue\n    }, opts);\n\n    if (opts.concurrency < 1) {\n      throw new TypeError('Expected `concurrency` to be a number from 1 and up');\n    }\n\n    this.queue = new opts.queueClass(); // eslint-disable-line new-cap\n\n    this._pendingCount = 0;\n    this._concurrency = opts.concurrency;\n\n    this._resolveEmpty = function () {};\n  }\n\n  (0, _createClass2.default)(PQueue, [{\n    key: \"_next\",\n    value: function _next() {\n      this._pendingCount--;\n\n      if (this.queue.size > 0) {\n        this.queue.dequeue()();\n      } else {\n        this._resolveEmpty();\n      }\n    }\n  }, {\n    key: \"add\",\n    value: function add(fn, opts) {\n      var _this = this;\n\n      return new _promise.default(function (resolve, reject) {\n        var run = function run() {\n          _this._pendingCount++;\n          fn().then(function (val) {\n            resolve(val);\n\n            _this._next();\n          }, function (err) {\n            reject(err);\n\n            _this._next();\n          });\n        };\n\n        if (_this._pendingCount < _this._concurrency) {\n          run();\n        } else {\n          _this.queue.enqueue(run, opts);\n        }\n      });\n    }\n  }, {\n    key: \"onEmpty\",\n    value: function onEmpty() {\n      var _this2 = this;\n\n      return new _promise.default(function (resolve) {\n        var existingResolve = _this2._resolveEmpty;\n\n        _this2._resolveEmpty = function () {\n          existingResolve();\n          resolve();\n        };\n      });\n    }\n  }, {\n    key: \"size\",\n    get: function get() {\n      return this.queue.size;\n    }\n  }, {\n    key: \"pending\",\n    get: function get() {\n      return this._pendingCount;\n    }\n  }]);\n  return PQueue;\n}();\n\nexports.default = PQueue;","map":null},"hash":"075b8ac64ca81908c278447560edbba9","cacheData":{"env":{}}}