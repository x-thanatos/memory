{"id":"spq1","dependencies":[{"name":"@babel/runtime-corejs2/helpers/interopRequireDefault","loc":{"line":3,"column":37},"parent":"/Users/thanatos/projects/memory/node_modules/next/dist/lib/page-loader.js","resolved":"/Users/thanatos/projects/memory/node_modules/@babel/runtime-corejs2/helpers/interopRequireDefault.js"},{"name":"@babel/runtime-corejs2/core-js/promise","loc":{"line":10,"column":46},"parent":"/Users/thanatos/projects/memory/node_modules/next/dist/lib/page-loader.js","resolved":"/Users/thanatos/projects/memory/node_modules/@babel/runtime-corejs2/core-js/promise.js"},{"name":"@babel/runtime-corejs2/helpers/classCallCheck","loc":{"line":12,"column":54},"parent":"/Users/thanatos/projects/memory/node_modules/next/dist/lib/page-loader.js","resolved":"/Users/thanatos/projects/memory/node_modules/@babel/runtime-corejs2/helpers/classCallCheck.js"},{"name":"@babel/runtime-corejs2/helpers/createClass","loc":{"line":14,"column":51},"parent":"/Users/thanatos/projects/memory/node_modules/next/dist/lib/page-loader.js","resolved":"/Users/thanatos/projects/memory/node_modules/@babel/runtime-corejs2/helpers/createClass.js"},{"name":"next-server/dist/lib/EventEmitter","loc":{"line":16,"column":51},"parent":"/Users/thanatos/projects/memory/node_modules/next/dist/lib/page-loader.js","resolved":"/Users/thanatos/projects/memory/node_modules/next-server/dist/lib/EventEmitter.js"}],"generated":{"js":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime-corejs2/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _promise = _interopRequireDefault(require(\"@babel/runtime-corejs2/core-js/promise\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime-corejs2/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime-corejs2/helpers/createClass\"));\n\nvar _EventEmitter = _interopRequireDefault(require(\"next-server/dist/lib/EventEmitter\"));\n/* global window, document */\n\n\nvar webpackModule = module;\n\nvar PageLoader =\n/*#__PURE__*/\nfunction () {\n  function PageLoader(_ref) {\n    var buildId = _ref.buildId,\n        assetPrefix = _ref.assetPrefix;\n    (0, _classCallCheck2.default)(this, PageLoader);\n    this.buildId = buildId;\n    this.assetPrefix = assetPrefix;\n    this.pageCache = {};\n    this.pageLoadedHandlers = {};\n    this.pageRegisterEvents = new _EventEmitter.default();\n    this.loadingRoutes = {};\n  }\n\n  (0, _createClass2.default)(PageLoader, [{\n    key: \"normalizeRoute\",\n    value: function normalizeRoute(route) {\n      if (route[0] !== '/') {\n        throw new Error(\"Route name should start with a \\\"/\\\", got \\\"\".concat(route, \"\\\"\"));\n      }\n\n      route = route.replace(/\\/index$/, '/');\n      if (route === '/') return route;\n      return route.replace(/\\/$/, '');\n    }\n  }, {\n    key: \"loadPage\",\n    value: function loadPage(route) {\n      var _this = this;\n\n      route = this.normalizeRoute(route);\n      return new _promise.default(function (resolve, reject) {\n        var fire = function fire(_ref2) {\n          var error = _ref2.error,\n              page = _ref2.page;\n\n          _this.pageRegisterEvents.off(route, fire);\n\n          delete _this.loadingRoutes[route];\n\n          if (error) {\n            reject(error);\n          } else {\n            resolve(page);\n          }\n        }; // If there's a cached version of the page, let's use it.\n\n\n        var cachedPage = _this.pageCache[route];\n\n        if (cachedPage) {\n          var error = cachedPage.error,\n              page = cachedPage.page;\n          error ? reject(error) : resolve(page);\n          return;\n        } // Register a listener to get the page\n\n\n        _this.pageRegisterEvents.on(route, fire); // If the page is loading via SSR, we need to wait for it\n        // rather downloading it again.\n\n\n        if (document.getElementById(\"__NEXT_PAGE__\".concat(route))) {\n          return;\n        } // Load the script if not asked to load yet.\n\n\n        if (!_this.loadingRoutes[route]) {\n          _this.loadScript(route);\n\n          _this.loadingRoutes[route] = true;\n        }\n      });\n    }\n  }, {\n    key: \"loadScript\",\n    value: function loadScript(route) {\n      var _this2 = this;\n\n      route = this.normalizeRoute(route);\n      var scriptRoute = route === '/' ? '/index.js' : \"\".concat(route, \".js\");\n      var script = document.createElement('script');\n      var url = \"\".concat(this.assetPrefix, \"/_next/static/\").concat(encodeURIComponent(this.buildId), \"/pages\").concat(scriptRoute);\n      script.src = url;\n\n      script.onerror = function () {\n        var error = new Error(\"Error when loading route: \".concat(route));\n        error.code = 'PAGE_LOAD_ERROR';\n\n        _this2.pageRegisterEvents.emit(route, {\n          error: error\n        });\n      };\n\n      document.body.appendChild(script);\n    } // This method if called by the route code.\n\n  }, {\n    key: \"registerPage\",\n    value: function registerPage(route, regFn) {\n      var _this3 = this;\n\n      var register = function register() {\n        try {\n          var _regFn = regFn(),\n              error = _regFn.error,\n              page = _regFn.page;\n\n          _this3.pageCache[route] = {\n            error: error,\n            page: page\n          };\n\n          _this3.pageRegisterEvents.emit(route, {\n            error: error,\n            page: page\n          });\n        } catch (error) {\n          _this3.pageCache[route] = {\n            error: error\n          };\n\n          _this3.pageRegisterEvents.emit(route, {\n            error: error\n          });\n        }\n      }; // Wait for webpack to become idle if it's not.\n      // More info: https://github.com/zeit/next.js/pull/1511\n\n\n      if (webpackModule && webpackModule.hot && webpackModule.hot.status() !== 'idle') {\n        console.log(\"Waiting for webpack to become \\\"idle\\\" to initialize the page: \\\"\".concat(route, \"\\\"\"));\n\n        var check = function check(status) {\n          if (status === 'idle') {\n            webpackModule.hot.removeStatusHandler(check);\n            register();\n          }\n        };\n\n        webpackModule.hot.status(check);\n      } else {\n        register();\n      }\n    }\n  }, {\n    key: \"clearCache\",\n    value: function clearCache(route) {\n      route = this.normalizeRoute(route);\n      delete this.pageCache[route];\n      delete this.loadingRoutes[route];\n      var script = document.getElementById(\"__NEXT_PAGE__\".concat(route));\n\n      if (script) {\n        script.parentNode.removeChild(script);\n      }\n    }\n  }]);\n  return PageLoader;\n}();\n\nexports.default = PageLoader;","map":null},"hash":"1a7c124e28d8ec3eca6f11b853256c36","cacheData":{"env":{}}}